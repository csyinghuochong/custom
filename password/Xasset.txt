资源打包：
   
   要打包的Asset
    public class AssetRef
    {
        public int bundle;                   bundle索引
        public int dir;                          dir索引    	
        public string name;                Bundle目录下的名字
    }
	
    //所有依赖到的Bundle
    public class BundleRef
    {
        public int[] deps;			
        public string hash;		//资源引用
        public int id;
        public long len;			
        public string name;		//资源名字
    }

    public class Manifest : ScriptableObject
    {
        public string[] activeVariants = new string[0];
        public AssetRef[] assets = new AssetRef[0];
        public BundleRef[] bundles = new BundleRef[0];
        public string[] dirs = new string[0];
    }

_tracker.Add(asset, assets);
如果被两个资源引用 。并且不在基础中bunlde，则单独打包
prefab的资源没有被引用  会把这个pefab锁包含的资源全部打包在一起


遍历所有要打包的资源
找到对应的依赖资源
if (dependencies.Length > 0)
                    foreach (var asset in dependencies)
                        if (ValidateAsset(asset))
                            Track(asset, bundle);



更新资源：
RequestCopy()
读取 C:/Users/Admin/AppData/LocalLow/yinghuochong/梦境传说/DLC/ver

再读取本地 "file:///D:/weijingHot/trunk_2021_0808/Unity/Assets/StreamingAssets/ver"

再读取tmp  var path = _savePath + Versions.Filename + ".tmp";

_step = hasFile && steamFileThenSave ? Step.Coping : Step.Versions;
如果streamAssets  并且版本比可读写目录的要高。   有文件则直接拷贝到 可读写目录。 

没有则远程下载ver.   再和本地的tmp 对比，看看是不是要断点续传


uirechrge:
14805    Assets/Res/UI/UIRes/Imgage/Img_410.png 
2604    Assets/Res/Effect/BackBlur/BackBlur.mat

启动：
Initialize
var request = new ManifestRequest {url = ManifestAsset};
            AddAssetRequest(request);
会初始化所有的assets 和 bundles列表

举例加载uirechrge：

1.
AssetRequest request = new BundleAssetRequest(assetBundleName);

 Dictionary<string, AssetRequest> _assets
_assets.Add(request.url, request);

 BundleAssetRequest （封装了一层的）
{
protected BundleRequest bundle = LoadBundle();

//核心代码在LoadBundle
load uirecharge
load dependlist
}


加载场景：  
SceneAssetRequest : AssetRequest
SceneAssetAsyncRequest : SceneAssetRequest

public static SceneAssetRequest LoadSceneAsync(string path, bool additive)
var asset = new SceneAssetAsyncRequest(path, additive);

最底层的加载api
AssetBundle.LoadFromFile

AssetRequest 
ManifestRequest : AssetRequest	清单文件
BundleAssetRequest : AssetRequest
SceneAssetRequest : AssetRequest
WebAssetRequest : AssetRequest
BundleRequest : AssetRequest

加载资源：
AssetRequest LoadAssetAsync

AssetRequest request))
if (_assets.TryGetValue(path, out request))
            {
                request.Retain();
                _loadingAssets.Add(request);		//第一手的assetbundle预制件
                return request;
            }


































